---
title: "Analyzing a 10 Year old Podcast"
author: "Nils Ratnaweera"
date: "2020-02-29T22:00:00+01:00"
categories: ["R"]
tags: ["webscraping","podcast","R"]
---



<p>I’ve been listening to the german astronomy Postcat <a href="http://raumzeit-podcast.de">“Raumzeit”</a> for quite a while now, and I had the idea to visualize some metrics of the podcast using R. I was interested to know what data I can aquire from the podcast and what I could do within it.</p>
<p>I started out using the podcast’s RSS feed with the library <code>tidyRSS</code>, but realized that not all episodes were <em>in</em> that feed. I therefore decided to scrape the podcast’s website instead. I also used <code>rtweet</code> to gather some metrics about the podcast using the tweets by the podcasts host Tim Pritlove, for which he uses the handle @raumzeit. I won’t show all code in this post, but you can get the whole Rmd file on my github page.</p>
<p>I use the following packages for this analysis, and set the ggplot default theme to <code>theme_classic</code>:</p>
<pre class="r"><code>library(tidyverse)
library(lubridate)
library(rvest)
library(ggrepel)
library(scales)
library(rtweet)

theme_set(theme_classic())</code></pre>
<div id="scraping-the-site" class="section level2">
<h2>Scraping the site</h2>
<p>Using chrome’s element inspector, I retrieved the css class names of the objects that I wanted to extract from the site, as in the following example.</p>
<pre class="r"><code>class_show &lt;- read_html(&quot;https://raumzeit-podcast.de/archiv/&quot;) %&gt;%
  html_nodes(&quot;.show&quot;)

titles &lt;- class_show %&gt;%
  html_nodes(&quot;.show__title&quot;) %&gt;%
  html_text() %&gt;%
  str_trim(&quot;both&quot;)</code></pre>
<p>Once I had all the data together, I gathered them in a <code>tibble</code> and started my analysis.</p>
<pre class="r"><code>head(folgenuebersicht)
## # A tibble: 6 x 6
##   title     date                duration item_link         rz_folge title_clean 
##   &lt;chr&gt;     &lt;dttm&gt;                 &lt;dbl&gt; &lt;chr&gt;                &lt;int&gt; &lt;chr&gt;       
## 1 RZ084 Be~ 2020-02-07 00:00:00      123 https://raumzeit~       84 Besuch beim~
## 2 RZ083 Sp~ 2020-01-17 00:00:00      164 https://raumzeit~       83 SpaceX      
## 3 RZ082 Bo~ 2019-12-20 00:00:00      127 https://raumzeit~       82 Bodenerkund~
## 4 Raumzeit~ 2019-12-05 00:00:00        8 https://raumzeit~       NA Raumzeit 20~
## 5 RZ081 Hu~ 2019-11-29 00:00:00      104 https://raumzeit~       81 Hubble-Welt~
## 6 RZ080 Eu~ 2019-11-07 00:00:00       88 https://raumzeit~       80 Europäische~</code></pre>
</div>
<div id="number-of-episodes-per-year" class="section level2">
<h2>Number of Episodes per Year</h2>
<p>The postcast has had different phases over the years and the number of podcasts released yeach year varyies significantly. The first Episode was released end of 2010. In 2011, Tim Pritlove published 25 episodes, the highest number of episodes he would ever publish thereafter. His project was initially funded by ESA and the Zeiss Grossplantarium, and when the two sponsors ended their conract in 2013, Tim took a break to regroup and find a different method to finance his podcast. He found a way and as of 2015, has be been steadily growing the number of episodes published each year.</p>
<p><img src="/post/2020_02_29_Raumzeit_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>What is remarkable about this podcast, is that Tim takes as much time as he needs with each guest, and doen’t really keep an eye on the time. This means that the podcast duration can very significantly, and I had wondered if there was some trend over time. Apperently, this does not seem to be the case, as shown in the following graph:</p>
<p><img src="/post/2020_02_29_Raumzeit_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="listner-interaction" class="section level2">
<h2>Listner interaction</h2>
<p>I was interested to know, how intense the interaction was in regard to each podcast. I found two metrics with which this can be quantified:</p>
<ul>
<li>The number of replies posted on the <a href="https://raumzeit-podcast.de/">podcat’s website</a></li>
<li>Twitter metrics (retweets, favorites, replies) of tweets Tim Pritlove posted after the appearance of a postcast with the user handle @raumzeit.</li>
</ul>
<div id="website-replies" class="section level3">
<h3>Website replies</h3>
<p>I scraped the website to retrieve the replies of year postcast using the podcast’s link an again, <code>rvest</code>:</p>
<pre class="r"><code>head(folgenuebersicht)
## # A tibble: 6 x 6
##   title     date                duration item_link         rz_folge title_clean 
##   &lt;chr&gt;     &lt;dttm&gt;                 &lt;dbl&gt; &lt;chr&gt;                &lt;int&gt; &lt;chr&gt;       
## 1 RZ084 Be~ 2020-02-07 00:00:00      123 https://raumzeit~       84 Besuch beim~
## 2 RZ083 Sp~ 2020-01-17 00:00:00      164 https://raumzeit~       83 SpaceX      
## 3 RZ082 Bo~ 2019-12-20 00:00:00      127 https://raumzeit~       82 Bodenerkund~
## 4 Raumzeit~ 2019-12-05 00:00:00        8 https://raumzeit~       NA Raumzeit 20~
## 5 RZ081 Hu~ 2019-11-29 00:00:00      104 https://raumzeit~       81 Hubble-Welt~
## 6 RZ080 Eu~ 2019-11-07 00:00:00       88 https://raumzeit~       80 Europäische~</code></pre>
<pre class="r"><code>replies &lt;- map_dfr(folgenuebersicht$item_link,function(x){
  vcard &lt;- x %&gt;%
    read_html() %&gt;%
    html_nodes(&quot;.comment-author.vcard&quot;) %&gt;%
    html_text() %&gt;%
    str_remove_all(&quot;\t|\n&quot;) 

  who &lt;- str_match(vcard,&quot;(.+)\\ssagte&quot;)[,2]
  datum &lt;- str_match(vcard,&quot;\\sam\\s(\\d+\\.\\s\\w+\\s\\d{4})\\sum&quot;)[,2]
  zeit &lt;- str_match(vcard,&quot;\\sum\\s(\\d+:\\d+)\\s&quot;)[,2]
  
  datumzeit &lt;- as.character(as.POSIXct(paste(datum,zeit),format = &quot;%d. %B %Y %H:%M&quot;))
  tibble(item_link = x, reply_author = who, reply_date = datumzeit)
}) %&gt;%
  mutate(reply_date = as.POSIXct(reply_date))</code></pre>
<pre class="r"><code>head(replies)
## # A tibble: 6 x 3
##   item_link                                     reply_author reply_date         
##   &lt;chr&gt;                                         &lt;chr&gt;        &lt;dttm&gt;             
## 1 https://raumzeit-podcast.de/2020/02/07/rz084~ Bende        2020-02-08 12:02:00
## 2 https://raumzeit-podcast.de/2020/02/07/rz084~ SwingBy      2020-02-08 14:49:00
## 3 https://raumzeit-podcast.de/2020/02/07/rz084~ SwingBy      2020-02-08 14:50:00
## 4 https://raumzeit-podcast.de/2020/02/07/rz084~ Glanzmispel  2020-02-08 15:29:00
## 5 https://raumzeit-podcast.de/2020/01/17/rz083~ Martin       2020-01-17 17:08:00
## 6 https://raumzeit-podcast.de/2020/01/17/rz083~ Martin       2020-01-21 13:38:00</code></pre>
<p>I want to visualize the replies of each postcast smiliar to a beaded curtain, where each vertical strand represents a conversation concerning one episode and each “bead” representining a post.</p>
<pre><code>## Warning: Removed 11 rows containing missing values (geom_path).
## Warning: Removed 11 rows containing missing values (geom_point).

## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="/post/2020_02_29_Raumzeit_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>folgen_replies_smry &lt;- folgen_replies %&gt;%
  group_by_at(1:6) %&gt;%
  count(name = &quot;Replies&quot;) %&gt;%
  arrange(-Replies) %&gt;%
  ungroup() %&gt;%
  mutate(
    title_clean = fct_reorder(title_clean,Replies)
    )</code></pre>
<pre class="r"><code>folgen_replies_smry %&gt;%
  head(20) %&gt;%
  ggplot(aes(title_clean,Replies)) +
  geom_col() +
  ggplot2::coord_flip() +
  labs(y = &quot;# Replies&quot;,x = &quot;&quot;)</code></pre>
<p><img src="/post/2020_02_29_Raumzeit_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>
folgen_replies_smry_filter &lt;- filter(folgen_replies_smry, Replies &gt; 40)

folgen_replies_smry %&gt;%
  ggplot(aes(date,Replies, label = title_clean)) +
  geom_point() +
  geom_point(data = folgen_replies_smry_filter, colour = &quot;red&quot;) +
  geom_label_repel(data = folgen_replies_smry_filter,min.segment.length = 0) +
  geom_smooth(method = &quot;loess&quot;,se = FALSE) +
  labs(y = &quot;# Replies&quot;,x = &quot;Release Date&quot;)</code></pre>
<p><img src="/post/2020_02_29_Raumzeit_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code>token &lt;- create_token(
  app = &quot;my_appname&quot;,
  consumer_key = &quot;my_key&quot;,
  consumer_secret = &quot;my_secret_key&quot;)</code></pre>
<p>I can now get the tweets by @raumzeit using the <code>get_timeline</code> function.</p>
<pre class="r"><code>raumtweets &lt;- get_timeline(&quot;raumzeit&quot;, n = 3200)</code></pre>
<pre class="r"><code>head(raumtweets)
## # A tibble: 6 x 90
##   user_id status_id created_at          screen_name text  source
##   &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; 
## 1 847908~ 12269491~ 2020-02-10 19:20:42 raumzeit    Wenn~ Tweet~
## 2 847908~ 12267746~ 2020-02-10 07:47:21 raumzeit    Der ~ Tweet~
## 3 847908~ 12257435~ 2020-02-07 11:30:05 raumzeit    @Mor~ Tweet~
## 4 847908~ 12257281~ 2020-02-07 10:28:47 raumzeit    @Mai~ Tweet~
## 5 847908~ 12257260~ 2020-02-07 10:20:36 raumzeit    Und ~ Tweet~
## 6 847908~ 12246586~ 2020-02-04 11:39:18 raumzeit    @Mai~ Tweet~
## # ... with 84 more variables: display_text_width &lt;dbl&gt;,
## #   reply_to_status_id &lt;chr&gt;, reply_to_user_id &lt;chr&gt;,
## #   reply_to_screen_name &lt;chr&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;,
## #   favorite_count &lt;int&gt;, retweet_count &lt;int&gt;, quote_count &lt;int&gt;,
## #   reply_count &lt;int&gt;, hashtags &lt;list&gt;, symbols &lt;list&gt;, urls_url &lt;list&gt;,
## #   urls_t.co &lt;list&gt;, urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;,
## #   media_t.co &lt;list&gt;, media_expanded_url &lt;list&gt;, media_type &lt;list&gt;,
## #   ext_media_url &lt;list&gt;, ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;,
## #   ext_media_type &lt;chr&gt;, mentions_user_id &lt;list&gt;, mentions_screen_name &lt;list&gt;,
## #   lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;, quoted_text &lt;chr&gt;,
## #   quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;, quoted_favorite_count &lt;int&gt;,
## #   quoted_retweet_count &lt;int&gt;, quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;,
## #   quoted_name &lt;chr&gt;, quoted_followers_count &lt;int&gt;,
## #   quoted_friends_count &lt;int&gt;, quoted_statuses_count &lt;int&gt;,
## #   quoted_location &lt;chr&gt;, quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,
## #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;, retweet_created_at &lt;dttm&gt;,
## #   retweet_source &lt;chr&gt;, retweet_favorite_count &lt;int&gt;,
## #   retweet_retweet_count &lt;int&gt;, retweet_user_id &lt;chr&gt;,
## #   retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;,
## #   retweet_followers_count &lt;int&gt;, retweet_friends_count &lt;int&gt;,
## #   retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,
## #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;,
## #   place_name &lt;chr&gt;, place_full_name &lt;chr&gt;, place_type &lt;chr&gt;, country &lt;chr&gt;,
## #   country_code &lt;chr&gt;, geo_coords &lt;list&gt;, coords_coords &lt;list&gt;,
## #   bbox_coords &lt;list&gt;, status_url &lt;chr&gt;, name &lt;chr&gt;, location &lt;chr&gt;,
## #   description &lt;chr&gt;, url &lt;chr&gt;, protected &lt;lgl&gt;, followers_count &lt;int&gt;,
## #   friends_count &lt;int&gt;, listed_count &lt;int&gt;, statuses_count &lt;int&gt;,
## #   favourites_count &lt;int&gt;, account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;,
## #   profile_url &lt;chr&gt;, profile_expanded_url &lt;chr&gt;, account_lang &lt;lgl&gt;,
## #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;</code></pre>
<p>I perticularly interested in the tweets regarding a specific podcast episode. Looking through the tweets I see that Tim usually uses the prefix “RZ” to refer to an episode, regretably, he is not completely concise in this. Non the less, let’s see how many</p>
<pre class="r"><code>raumtweets$rz_folge &lt;- as.integer(str_match(raumtweets$text,&quot;RZ(\\d{1,3})&quot;)[,2])</code></pre>
<p>We’ve got 133 assigned tweets and 445 NAs with up to 5 tweets for a single episode. However, there is another way to assign a tweet to an episode: Via the URL linking to the epiode. So let’s extract these URLs from the column <code>urls_expanded_url</code>.</p>
<pre class="r"><code>raumtweets$item_link &lt;- map_chr(raumtweets$urls_expanded_url,function(x){
  out &lt;- x[str_detect(x,&quot;raumzeit-podcast.de/\\d{4}&quot;)]
  ifelse(length(out)&lt;0,NA_character_,out)
  })</code></pre>
<pre class="r"><code>raumtweets_folgen &lt;- raumtweets %&gt;%
  left_join(select(filter(folgenuebersicht,!is.na(rz_folge)),title_clean,date,item_link), by = &quot;item_link&quot;) %&gt;%
  left_join(select(filter(folgenuebersicht,!is.na(rz_folge)),title_clean,date,rz_folge), by = &quot;rz_folge&quot;) %&gt;%
  mutate(
    title_clean = coalesce(title_clean.x,title_clean.y),
    date = coalesce(date.x,date.y)
  ) %&gt;%
  select(-c(title_clean.x,title_clean.y,date.x,date.y)) %&gt;%
  filter(!is.na(title_clean))

raumtweets_folgen_smry &lt;- raumtweets_folgen %&gt;%
  group_by(title_clean,date) %&gt;% 
  summarise_at(vars(favorite_count,retweet_count,reply_count),max, na.rm = TRUE)


raumtweets_folgen_smry_filter &lt;- filter(raumtweets_folgen_smry,retweet_count&gt;30)</code></pre>
<pre class="r"><code>ggplot(raumtweets_folgen_smry, aes(date,retweet_count,label = title_clean)) +
  geom_point() +
  geom_point(data = raumtweets_folgen_smry_filter,colour = &quot;red&quot;) +
  geom_smooth(method = &quot;loess&quot;,se = FALSE) +
  geom_label_repel(data = raumtweets_folgen_smry_filter,nudge_x = 5,nudge_y = 5) +
  labs(x = &quot;Publish Date&quot;, y = &quot;Retweet Count (Maxium)&quot;)</code></pre>
<p><img src="/post/2020_02_29_Raumzeit_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>
raumtweets_folgen_smry_filter = filter(raumtweets_folgen_smry,favorite_count&gt;70)
ggplot(raumtweets_folgen_smry, aes(date,favorite_count,label = title_clean)) +
  geom_point() +
  geom_point(data = raumtweets_folgen_smry_filter, colour = &quot;red&quot;) +
  geom_smooth(method = &quot;loess&quot;,se = FALSE)  +
  geom_label_repel(data = raumtweets_folgen_smry_filter, nudge_x = 5,nudge_y = 5) +
  labs(x = &quot;Publish Date&quot;, y = &quot;Favorites Count (Maxium)&quot;)</code></pre>
<p><img src="/post/2020_02_29_Raumzeit_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
</div>
</div>
